<html><head><meta charset='utf-8'><title>QA Automation Report</title>
<style>
body { background-color: #1e1e1e; color: #ddd; font-family: Arial, sans-serif; margin:0; padding:0; }
h1 { color: #fff; padding: 10px 0 10px 16px; margin:0; }
#login-container { display: flex; align-items: center; justify-content: center; height: 100vh; flex-direction: column; }
#login-box { background-color: #2b2b2b; padding: 30px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); }
#login-box h2 { margin-top: 0; color: #fff; }
#password-input { width: 250px; padding: 10px; margin: 10px 0; background-color: #1e1e1e; border: 1px solid #444; color: #ddd; border-radius: 4px; }
#login-button { padding: 10px 20px; background-color: #2e7d32; color: #fff; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; }
#login-button:hover { background-color: #1b5e20; }
#error-message { color: #c62828; margin-top: 10px; display: none; }
#dashboard-content { display: none; }
table { border-collapse: collapse; }
th, td { border: 1px solid #444; text-align: center; padding: 6px; }
th { background-color: #2b2b2b; font-weight: bold; position: sticky; top: 0; z-index: 2; }
th::before { content: ''; position: absolute; top: -1px; left: 0; right: 0; height: 1px; background-color: #2b2b2b; }
th:first-child { position: sticky; left: 0; z-index: 4; background-color: #2b2b2b; text-align: left; padding-left: 8px; border-right: 2px solid #444; }
th:first-child::before { content: ''; position: absolute; top: -1px; left: -1px; width: calc(100% + 1px); height: calc(100% + 1px); background-color: #2b2b2b; z-index: -1; }
td.green { background-color: #2e7d32; color: #fff; cursor: pointer; }
td.yellow { background-color: #f9a825; color: #000; cursor: pointer; }
td.red { background-color: #c62828; color: #fff; cursor: pointer; }
td.green:hover, td.yellow:hover, td.red:hover { opacity: 0.8; }
td.empty { background-color: #2b2b2b; color: #666; }
td.project-separator { background-color: #1e1e1e; }
.suite-name { position: sticky; left: 0; background-color: #1e1e1e; width: 295px; text-align: left; padding-left: 8px; font-weight: normal; z-index:1; border-right: 2px solid #444; }
.suite-name::before { content: ''; position: absolute; left: -1px; top: 0; width: 1px; bottom: 0; background-color: #1e1e1e; }
.project-header { position: sticky; left: 0; display: table-cell; background-color: #1e1e1e; text-align: left; padding-left: 8px; font-weight: bold; z-index: 1; border-right: 2px solid #444; border-bottom: 2px solid #444; }
.project-header::before { content: ''; position: absolute; left: -1px; top: 0; width: 1px; bottom: 0; background-color: #1e1e1e; }
.table-container { overflow-x: auto; overflow-y: auto; max-height: 90vh; }
.tooltip { position: absolute; display: none; background-color: #2b2b2b; border: 1px solid #444; padding: 10px; border-radius: 4px; z-index: 1000; pointer-events: none; white-space: nowrap; }
.tooltip-row { margin: 3px 0; }
.tooltip-label { font-weight: bold; display: inline-block; width: 100px; }
</style>
<script>
const PASSWORD_HASH = '3718db2207be42cabda43cdfedb181ffef206cfda7ad775c7ba9e524104d2a32';
const data = {"DYNAREX": {"Test Suites/7_market value page": {"2025.10.09": {"html_file": "docs/reports/20251009_015509_1759976881576.html", "project": "DYNAREX", "test_suite_id": "Test Suites/7_market value page", "profile": "default DYNAREX intdev", "test_cases": 7, "passed": 7, "failed": 0, "error": 0, "incomplete": 0, "skipped": 0, "start": "2025-10-09T04:23:41.121+02:00", "end": "2025-10-09T04:28:01.017+02:00", "duration": 4.3316, "retry_count": 0, "sum_check": true, "color": "green"}}, "Test Suites/6_valuation/6e_Manual Valuation": {"2025.10.09": {"html_file": "docs/reports/20251009_015505_1759976616963.html", "project": "DYNAREX", "test_suite_id": "Test Suites/6_valuation/6e_Manual Valuation", "profile": "default", "test_cases": 3, "passed": 0, "failed": 3, "error": 0, "incomplete": 0, "skipped": 0, "start": "2025-10-09T04:19:46.016+02:00", "end": "2025-10-09T04:23:33.898+02:00", "duration": 3.7980333333333336, "retry_count": 0, "sum_check": true, "color": "red"}}}};

async function hashPassword(password) {
  const msgBuffer = new TextEncoder().encode(password);
  const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
  const hashArray = Array.from(new Uint8Array(hashBuffer));
  return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
}

async function checkPassword() {
  const password = document.getElementById('password-input').value;
  const hash = await hashPassword(password);
  if (hash === PASSWORD_HASH) {
    sessionStorage.setItem('reportPassword', password);
    document.getElementById('login-container').style.display = 'none';
    document.getElementById('dashboard-content').style.display = 'block';
  } else {
    document.getElementById('error-message').style.display = 'block';
  }
}

document.addEventListener('DOMContentLoaded', function() {
  const savedPassword = sessionStorage.getItem('reportPassword');
  if (savedPassword) {
    hashPassword(savedPassword).then(hash => {
      if (hash === PASSWORD_HASH) {
        document.getElementById('login-container').style.display = 'none';
        document.getElementById('dashboard-content').style.display = 'block';
      }
    });
  }
  document.getElementById('password-input').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') checkPassword();
  });
});

function showTooltip(e, project, suite, date) {
  const record = data[project][suite][date];
  if (!record) return;
  const tooltip = document.getElementById('tooltip');
  const start = new Date(record.start);
  const end = new Date(record.end);
  const formatDate = (d) => d.getFullYear().toString().slice(2) + '/' + 
    String(d.getMonth()+1).padStart(2,'0') + '/' + String(d.getDate()).padStart(2,'0') + ' - ' +
    String(d.getHours()).padStart(2,'0') + ':' + String(d.getMinutes()).padStart(2,'0') + ':' + String(d.getSeconds()).padStart(2,'0');
  const totalSeconds = Math.floor(record.duration * 60);
  const minutes = Math.floor(totalSeconds / 60);
  const seconds = totalSeconds % 60;
  const durationStr = String(minutes).padStart(2,'0') + ':' + String(seconds).padStart(2,'0');
  tooltip.innerHTML = `
    <div class='tooltip-row'><span class='tooltip-label'>Profile:</span><strong>${record.profile || 'N/A'}</strong></div>
    <div class='tooltip-row'><span class='tooltip-label'>Test Cases:</span>${record.test_cases || 0}</div>
    <div class='tooltip-row'><span class='tooltip-label'>Passed:</span>${record.passed || 0}</div>
    <div class='tooltip-row'><span class='tooltip-label'>Failed:</span>${record.failed || 0}</div>
    <div class='tooltip-row'><span class='tooltip-label'>Error:</span>${record.error || 0}</div>
    <div class='tooltip-row'><span class='tooltip-label'>Incomplete:</span>${record.incomplete || 0}</div>
    <div class='tooltip-row'><span class='tooltip-label'>Skipped:</span>${record.skipped || 0}</div>
    <div class='tooltip-row'><span class='tooltip-label'>Retry:</span>${record.retry_count || 0}</div>
    <div class='tooltip-row'><span class='tooltip-label'>Start:</span>${formatDate(start)}</div>
    <div class='tooltip-row'><span class='tooltip-label'>End:</span>${formatDate(end)}</div>
    <div class='tooltip-row'><span class='tooltip-label'>Duration:</span>${durationStr}</div>
  `;
  tooltip.style.display = 'block';
  tooltip.style.left = (e.pageX + 10) + 'px';
  tooltip.style.top = (e.pageY + 10) + 'px';
}
function hideTooltip() {
  document.getElementById('tooltip').style.display = 'none';
}

// ðŸ”’ Live decryption of HTML reports
async function openReport(project, suite, date) {
  const record = data[project][suite][date];
  if (!record || !record.html_file) return;
  const password = sessionStorage.getItem('reportPassword');
  if (!password) { alert('Password not found in session. Please login again.'); return; }
  try {
    const response = await fetch(record.html_file.replace('docs/', ''));
    const encryptedData = new Uint8Array(await response.arrayBuffer());
    const enc = new TextEncoder();
    const pwBytes = enc.encode(password);
    const keyMaterial = await crypto.subtle.importKey('raw', pwBytes, { name: 'PBKDF2' }, false, ['deriveKey']);
    const salt = enc.encode('qa_automation_salt');
    const key = await crypto.subtle.deriveKey({ name: 'PBKDF2', salt, iterations: 100000, hash: 'SHA-256' }, keyMaterial, { name: 'AES-GCM', length: 256 }, false, ['decrypt']);
    const nonce = encryptedData.slice(0, 12);
    const ciphertext = encryptedData.slice(12);
    const decrypted = await crypto.subtle.decrypt({ name: 'AES-GCM', iv: nonce }, key, ciphertext);
    const htmlText = new TextDecoder().decode(decrypted);
    const blob = new Blob([htmlText], { type: 'text/html' });
    const url = URL.createObjectURL(blob);
    window.open(url, '_blank');
  } catch(e) { console.error('Failed to decrypt report:', e); alert('Failed to decrypt report.'); }
}
</script>
</head><body>
<div id='login-container'>
  <div id='login-box'>
    <h2>QA Automation Report</h2>
    <div>
      <input type='password' id='password-input' placeholder='Enter password' autofocus>
    </div>
    <div>
      <button id='login-button' onclick='checkPassword()'>Login</button>
    </div>
    <div id='error-message'>Incorrect password. Please try again.</div>
  </div>
</div>
<div id='dashboard-content'>
<div id='tooltip' class='tooltip'></div>
<h1>QA Automation Report</h1>
<div class='table-container'>
<table>
<tr><th>Test Suite</th><th>10.09</th></tr>
<tr><td class='project-header'>DYNAREX</td><td class='project-separator'></td></tr>
<tr><td class='suite-name'>6_valuation/6e_Manual Valuation</td>
<td class='red' onmousemove='showTooltip(event, "DYNAREX", "Test Suites/6_valuation/6e_Manual Valuation", "2025.10.09")' onmouseleave='hideTooltip()' onclick='openReport("DYNAREX", "Test Suites/6_valuation/6e_Manual Valuation", "2025.10.09")'>0/3</td>
</tr>
<tr><td class='suite-name'>7_market value page</td>
<td class='green' onmousemove='showTooltip(event, "DYNAREX", "Test Suites/7_market value page", "2025.10.09")' onmouseleave='hideTooltip()' onclick='openReport("DYNAREX", "Test Suites/7_market value page", "2025.10.09")'>7/0</td>
</tr>
</table>
</div>
</div>
</body></html>